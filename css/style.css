/* ============
   固定キャンバス（360×780）
============ */
:root{
  --appW: 360px;
  --appH: 780px;

  /* スロット/オーブ */
  --slotW: 48px;
  --slotH: 72px;
  --slotGap: 6px;

  --orbOuter: 16px; /* 外径 */
  --orbCore: 10px;  /* コア径 */
  --ringW: 3px;

  /* 色 */
  --c-bg: #f6f7fb;
  --c-panel: #ffffff;
  --c-line: #d0d4dd;
  --c-text: #222;
  --c-sub: #666;

  --c-gray: #9aa0a6;
  --c-gray2:#c7cbd1;

  --c-guard:#2da9ff;
  --c-invert:#a94dff;

  --c-white:#f0f0f0;
  --c-black:#111;

  --c-gold:#d4af37;

  --hl: rgba(45,169,255,0.35);
}

*{ box-sizing:border-box; }
body{
  margin:0;
  font-family: system-ui, -apple-system, "Segoe UI", sans-serif;
  color:var(--c-text);
  background: #111; /* 周囲 */
}

#stage{
  min-height:100vh;
  display:flex;
  align-items:flex-start;
  justify-content:center;
  padding: 12px;
}

/* app本体は常に360×780の論理サイズ */
#app{
  width: var(--appW);
  height: var(--appH);
  background: var(--c-bg);
  border-radius: 14px;
  overflow:hidden;
  box-shadow: 0 10px 30px rgba(0,0,0,0.35);
  position:relative;
}

/* ---- セーフエリアの“仕込み”だけ（今は無視してOK） ----
   stageに class="safe" を付けたら効く（後で有効化できる）
*/
#stage.safe #app{
  transform: translateY(env(safe-area-inset-top));
}

/* ============
   Topbar
============ */
#topbar{
  padding: 10px 10px 8px;
  background: #fff;
  border-bottom: 1px solid var(--c-line);
}
.toprow{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:10px;
}
.title{
  font-weight: 700;
  font-size: 14px;
}
.controls{
  display:flex;
  gap:6px;
  align-items:center;
  flex-wrap:wrap;
  justify-content:flex-end;
}
.player.dim{
  filter: grayscale(100%) brightness(0.92);
  opacity: 0.75;
}
button{
  border:1px solid var(--c-line);
  background:#fff;
  border-radius:10px;
  padding:6px 10px;
  font-size:12px;
}
button.ghost{
  background:transparent;
}
button:disabled{
  opacity:0.45;
}
label.inline{
  display:flex;
  gap:6px;
  align-items:center;
  font-size:12px;
  color:var(--c-sub);
}
select{
  border:1px solid var(--c-line);
  border-radius:10px;
  padding:5px 8px;
  font-size:12px;
  background:#fff;
}
.statusrow{
  margin-top:6px;
  display:flex;
  justify-content:space-between;
  gap:8px;
  font-size:12px;
  color:var(--c-sub);
}
#txtStatus{ font-weight:600; color:#333; }
#txtActing{ text-align:right; }

/* ============
   Board
============ */
#board{
  height: calc(var(--appH) - 62px);
  padding:8px;
  display:flex;
  flex-direction:column;
  gap:10px;
  overflow:auto;              /* ★追加 */
}

/* 2×2 */
.players{
  display:grid;
  grid-template-columns: 1fr 1fr;
  gap:8px;
}

/* ============
   Player card
============ */
.player{
  background: var(--c-panel);
  border: 1px solid var(--c-line);
  border-radius: 14px;
  padding: 8px;
  display:flex;
  flex-direction:column;
  gap:6px;
  min-height: 290px;
}

.playerHeader{
  display:flex;
  justify-content:space-between;
  align-items:flex-start;
  gap:8px;
}

.pname{
  font-weight:700;
  font-size:13px;
}
.badges{
  display:flex;
  gap:6px;
  flex-wrap:wrap;
  justify-content:flex-end;
}

.badge{
  border:1px solid var(--c-line);
  background:#fff;
  padding:2px 6px;
  border-radius:999px;
  font-size:11px;
  color:#333;
  white-space:nowrap;
}
.badge.mediumOn  { border-color:#222; color:#222; background:#fff; }
.badge.mediumOff { border-color:#bbb; color:#777; background:#f7f7f7; }
.badge.mediumNone{ border-color:#ddd; color:#aaa; background:#fafafa; }
.badge.retired{
  border-color:#ddd;
  color:#aaa;
  background:#fafafa;
}

.grid{
  display:grid;
  grid-template-columns: repeat(3, var(--slotW));
  grid-template-rows: repeat(3, var(--slotH));
  gap: var(--slotGap);
  justify-content:center;
}

/* ============
   Slot
============ */
.slot{
  width: var(--slotW);
  height: var(--slotH);
  border-radius: 12px;
  border: 1px solid #cfd3db;
  background: #fbfbfe;
  position:relative;
  overflow:visible;
}

/* カード感（内側影） */
.slot::before{
  content:"";
  position:absolute;
  inset:2px;
  border-radius:10px;
  box-shadow: inset 0 1px 0 rgba(255,255,255,0.9),
              inset 0 -2px 6px rgba(0,0,0,0.06);
}

/* DEAD / disabled は同一フィルター */
.slot.dead,
.slot.disabled{
  filter: grayscale(100%) brightness(0.80);
}

/* 選択可能なホバー（PC用） */
.slot.clickable:hover{
  outline: 2px solid rgba(45,169,255,0.35);
  outline-offset: 1px;
}

/* 選択中ハイライト（dead/disabledは付けない方針） */
.slot.selected{
  box-shadow: 0 0 0 2px rgba(45,169,255,0.35),
              0 0 10px rgba(45,169,255,0.25);
}

/* 中央（仮：役職1文字） */
.role{
  position:absolute;
  left:50%;
  top:50%;
  transform: translate(-50%,-50%);
  width:32px;
  height:56px;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size: 28px;
  font-weight: 800;
  line-height:1;
  user-select:none;
  pointer-events:none;
  z-index: 2;
}

/* ============
   Orbs (4 corners)
============ */
.orb.tl{ left:3px; top:3px; }
.orb.tr{ right:3px; top:3px; }
.orb.br{ right:3px; bottom:3px; }
.orb.bl{ left:3px; bottom:3px; }
.orb{
  position:absolute;
  width: var(--orbOuter);
  height: var(--orbOuter);
  border-radius:50%;
  overflow:hidden;
  pointer-events:none;
}

.orb .ring{
  position:absolute;
  inset:0;
  z-index: 2;   /* ← 上に */
}

.orb .core{
  position:absolute;
  left:50%;
  top:50%;
  transform: translate(-50%,-50%);
  width: var(--orbCore);
  height: var(--orbCore);
  border-radius:50%;
  z-index: 1;   /* ← 下に */
}

/* “有効”表示はコアを濃く */
.orb.active .core{ opacity: 1; }

/* コア色 */
.core.guard{ background: var(--c-guard); }
.core.invert{ background: var(--c-invert); }
.core.gray{ background: var(--c-gray); opacity: 0.65; }
.core.white{ background: var(--c-white); box-shadow: inset 0 0 0 1px rgba(0,0,0,0.15); }
.core.black{ background: var(--c-black); }

/* リング色（公開占い＝金） */
.orb.public{
  box-shadow:
    0 0 0 1px rgba(160,110,0,0.85) inset,
    0 0 0 1px rgba(255,220,120,0.95);
}

/* ============
   Log
============ */
.logbox{
  margin-top:auto;
  border: 1px solid var(--c-line);
  border-radius: 12px;
  background:#fff;
  overflow:hidden;
}
.logbox > summary{
  padding: 8px 10px;
  cursor:pointer;
  font-size:12px;
  color:var(--c-sub);
  border-bottom: 1px solid var(--c-line);
}
#logText{
  margin:0;
  padding:10px;
  font-size:11px;
  max-height: 220px;
  overflow:auto;
  white-space:pre-wrap;
}
